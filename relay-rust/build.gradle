tasks.register('debug', Exec) {
    commandLine 'cargo', 'build'
}

tasks.register('release', Exec) {
    commandLine 'cargo', 'build', '--release'
}

tasks.register('test', Exec) {
    commandLine 'cargo', 'test'
}

tasks.register('install', Exec) {
    commandLine 'cargo', 'install'
}

tasks.register('clean', Exec) {
    commandLine 'cargo', 'clean'
}

tasks.register('checkstyle', Exec) {
    commandLine 'cargo', 'fmt', '--', '--check'
}

tasks.register('check') { dependsOn('checkstyle', 'test') }
tasks.register('build') { dependsOn('check', 'debug', 'release') }

// Requirements:
//
// Install the cross-compile toolchain (on Debian):
//   sudo apt install gcc-mingw-w64-x86-64
//   rustup target add x86_64-pc-windows-gnu
//
// Add the following lines to ~/.cargo/config:
//   [target.x86_64-pc-windows-gnu]
//   linker = "x86_64-w64-mingw32-gcc"
//   ar = "x86_64-w64-mingw32-gcc-ar"
tasks.register('releaseCrossToWindows', Exec) {
    commandLine 'cargo', 'build', '--release', '--target=x86_64-pc-windows-gnu'
}
